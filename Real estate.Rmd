---
title: "Toronto Real Estate"
output:
  word_document: default
  html_document: default
  pdf_document: default
urlcolor: blue
---
#Load packages
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```

```{r}
realestatedata <- read.csv("real-estate-data.csv")
```

# Descriptive statistics of the real estate dataset
```{r}
summary(realestatedata)
class(realestatedata)
table(realestatedata$size)
```

# Distributions of factors affecting Toronto housing prices
```{r} 
ggplot(data = realestatedata, aes(x = price))+geom_histogram(position = "dodge", bins = 50, fill = "lightblue", color = "black") + labs(title = "Price Distribution")
```

```{r}
ggplot(data = realestatedata, aes(x = size, fill = ))+geom_bar(position = "dodge", bins = 30, fill = "lightgreen", color = "black") + labs(title = "Size Distribution")
```

```{r}
ggplot(data = realestatedata, aes(x = building_age, fill = ))+geom_bar(position = "dodge", bins = 30, fill = "lightpink", color = "black") + labs(title = "Building Age Distribution")
```

```{r}
ggplot(data = realestatedata, aes(x = maint, fill = ))+geom_histogram(position = "dodge", bins = 30, fill = "lightyellow", color = "black") + labs(title = "Monthly Maintenance Fee Distribution")
```

```{r}
ggplot(data = realestatedata, aes(x = beds, fill = ))+geom_bar(position = "dodge", bins = 30, fill = "green", color = "black") + labs(title = "Number of Beds")
```

# Data visualizations comparing Toronto housing price and related factors
```{r} 
ggplot(data = realestatedata, aes(x = size, y = price))+geom_boxplot(fill="lightblue") + labs(title = "Size vs. Housing Price")
```

```{r} 
ggplot(data = realestatedata, aes(x = building_age, y = price))+geom_point()+ labs(title = "Building Age vs. Housing Price")
```

# Exploring the correlation between the housing prices provided by the dataset and the prices generated by our multiple linear regression model
```{r}
modelrem <- lm(formula = price ~ ward + beds + baths + DEN + size + parking + D_mkt + building_age + exposure + maint + lt +lg, data = realestatedata)
summary(modelrem)

predictionsall <- predict(modelrem, newdata = realestatedata)

realestatedata$Predicted_Price_All <- predictionsall

plot(predictionsall)

ggplot(data = realestatedata, aes(y = price, x = predictionsall))+geom_point()+geom_smooth(method=lm)
```
If the p-value of the predictor (intercept) was less than 0.05, it has a statistically significant relationship with housing prices. This means that there is a less than 5% likelihood that the observed values were found by chance. The R-squared value was computed to be 0.9203, which indicates that approximately 92.03% of the variation in Toronto housing prices can be represented by the predictors in this model.

# Descriptive statistics for predicted housing prices
```{r}
new <- data.frame(lt=c(-43.64), lg=c(-79.35))

predicted_prices <- predict(modelrem, realestatedata=new)

plot(predicted_prices)
summary(predicted_prices)
```

# Predictor models
```{r}
modelage <- lm(price ~ building_age , data = realestatedata)
summary(modelage)
plot(modelage, which=1)
predictions <- predict(modelage, newdata = realestatedata)

realestatedata$Predicted_Price <- predictions

ggplot(data = realestatedata, aes(y = predictions, x = building_age))+geom_point() + labs(title = "Building Age vs. Predicted Housing Price")
```

```{r}
modelsize <- lm(price ~ size , data = realestatedata)
summary(modelsize)
plot(modelsize, which=1)
predictions <- predict(modelsize, newdata = realestatedata)

realestatedata$Predicted_Price <- predictions

ggplot(data = realestatedata, aes(y = predictions, x = size))+geom_point() + labs(title = "Size vs. Predicted Housing Price")
```

```{r}
modelmaint <- lm(price ~ maint , data = realestatedata)
summary(modelmaint)
plot(modelmaint, which=1)

predictions <- predict(modelmaint, newdata = realestatedata)

realestatedata$Predicted_Price <- predictions

ggplot(data = realestatedata, aes(y = predictions, x = maint))+geom_point()+ labs(title = "Monthly Maintenance Fees vs. Predicted Housing Price")
```

```{r}
modelage <- lm(price ~ building_age , data = realestatedata)
summary(modelage)
plot(modelage, which=1)

predictions <- predict(modelage, newdata = realestatedata)

realestatedata$Predicted_Price <- predictions

ggplot(data = realestatedata, aes(y = predictions, x = building_age))+geom_point()+ labs(title = "Building Age vs. Predicted Housing Price")
```

```{r}
modelward <- lm(price ~ building_age , data = realestatedata)
summary(modelward)
plot(modelward, which=1)

predictions <- predict(modelward, newdata = realestatedata)

realestatedata$Predicted_Price <- predictions

ggplot(data = realestatedata, aes(y = predictions, x = ward))+geom_boxplot(fill="lightgreen") + labs(title = "Ward vs. Predicted Housing Price")
```
